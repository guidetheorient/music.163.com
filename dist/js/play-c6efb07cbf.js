"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};$(function(){function n(n,a){var t=$("<img/>");$("#app .song-bg").css({"background-image":"url("+a+")"}),t.attr({src:n,class:"cover"}).appendTo($(".default-cover"))}function a(n){function a(n){return 1===(""+parseInt(n)).length?n="0"+n:n+="",n}var t=document.createElement("audio"),e=$("#app .disc"),o=$(".needle"),r=$(".disc-container .play-btn"),s=$(".disc .pause-btn"),i=$("body");t.src=n;var c=0;t.oncanplay=function(){i.one("click",function(n){if(n.currentTarget===i[0]&&n.target!==r[0]){if(c>0)return;n.stopPropagation(),t.play(),e.removeClass("paused").addClass("playing"),o.addClass("active")}})},t.onended=function(){e.addClass("paused").removeClass("playing"),o.removeClass("active")},r.click(function(n){c=1,n.stopPropagation(),t.play(),e.removeClass("paused").addClass("playing"),o.addClass("active")}),s.click(function(n){n.stopPropagation(),t.pause(),e.addClass("paused").removeClass("playing"),o.removeClass("active")}),t.ontimeupdate=function(){var n=$(".lrc"),e=$(".lrc-line"),o=e.length,r=t.currentTime,s=parseInt(r/60),i=r%60;r=a(s)+":"+a(i),e.each(function(a,t){if(r>$(t).attr("data-time")&&(r<e.eq(a+1).attr("data-time")||a===o-1)){var s=e.eq(a).offset().top-n.offset().top;return n.css({transform:"translateY(-"+s+"px)"}),void $(t).addClass("active").prev().removeClass("active")}})}}function t(n){var a=n.split("\n"),t=/\[\d+:\d+\.\d+\]/,e=/\[(.+)\](.*)/;return a=(a=a.filter(function(n){return!(!t.test(n)||""==n)})).map(function(n){var a=e.exec(n);if(a)return{time:a[1],line:a[2]}})}function e(n,a,e,o){var r=$(".song-info");$('\n      <div class="title">\n        <span class="song-name">'+n+'</span>\n        <span>-</span>\n        <span class="song-author">'+a+"</span>\n      </div>\n    ").prependTo(r);var s=$(".lrc-wrap"),i=$('<div class="lrc"></div>');e?$.get("//owf5g9dnv.bkt.clouddn.com/lrc/"+(o+1)+".json").then(function(n){var a=n.lrc.lyric,e=n.tlyric.lyric,o=t(a);if(void 0!==(void 0===e?"undefined":_typeof(e))){var r=t(e);o.map(function(n,a){var t=n,e=a;r.forEach(function(n,a){n.time===t.time&&(o[e].line2=n.line)})})}o.map(function(n){var a=$("<span></span>"),t=$("<span></span>"),e=$("<p></p>");a.attr({class:"origin-lrc-line"}).text(n.line),t.attr({class:"translate-lrc-line"}).text(n.line2),e.attr({"data-time":n.time,class:"lrc-line"}).append(a,t),i.append(e)}),s.append(i)}):$("<p></p>").attr({class:"lrc-line"}).text("纯音乐，无歌词").appendTo(i).appendTo(s)}var o=window.location.search,r=Number(o.match(/\?id=(\d+)/)[1]);$.get("//owf5g9dnv.bkt.clouddn.com/songsDB.json?v=20170922").then(function(t){var o=t[r],s=o.coverUrl,i=o.backgroundImgUrl,c=o.url,l=o.songName,p=o.songAuthor,d=o.hasLrc;n(s,i),a(c),e(l,p,d,r)})});