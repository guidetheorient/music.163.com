"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};$(function(){function n(n,t){var a=$("<img/>");$("#app .song-bg").css({"background-image":"url("+t+")"}),a.attr({src:n,class:"cover"}).appendTo($(".default-cover"))}function t(n){function t(n){return 1===(""+parseInt(n)).length?n="0"+n:n+="",n}var a=document.createElement("audio"),e=$("#app .disc"),o=$(".needle"),r=$(".disc-container .play-btn"),s=$(".disc .pause-btn"),i=$("body");a.src=n,a.oncanplay=function(){i.one("touchstart",function(n){n.target!==r[0]&&(n.stopPropagation(),a.play(),e.addClass("playing"),o.addClass("active"))})},a.onended=function(){e.addClass("paused").removeClass("playing"),o.removeClass("active")},r.click(function(n){n.stopPropagation(),a.play(),e.removeClass("paused").addClass("playing"),o.addClass("active")}),s.click(function(n){n.stopPropagation(),a.pause(),e.addClass("paused").removeClass("playing"),o.removeClass("active")}),a.ontimeupdate=function(){var n=$(".lrc"),e=$(".lrc-line"),o=e.length,r=a.currentTime,s=parseInt(r/60),i=r%60;r=t(s)+":"+t(i),e.each(function(t,a){if(r>$(a).attr("data-time")&&(r<e.eq(t+1).attr("data-time")||t===o-1)){var s=e.eq(t).offset().top-n.offset().top;return n.css({transform:"translateY(-"+s+"px)"}),void $(a).addClass("active").prev().removeClass("active")}})}}function a(n){var t=n.split("\n"),a=/\[\d+:\d+\.\d+\]/,e=/\[(.+)\](.*)/;return t=(t=t.filter(function(n){return!(!a.test(n)||""==n)})).map(function(n){var t=e.exec(n);if(t)return{time:t[1],line:t[2]}})}function e(n,t,e,o){var r=$(".song-info");$('\n      <div class="title">\n        <span class="song-name">'+n+'</span>\n        <span>-</span>\n        <span class="song-author">'+t+"</span>\n      </div>\n    ").prependTo(r);var s=$(".lrc-wrap"),i=$('<div class="lrc"></div>');e?$.get("//owf5g9dnv.bkt.clouddn.com/lrc/"+(o+1)+".json").then(function(n){var t=n.lrc.lyric,e=n.tlyric.lyric,o=a(t);if(void 0!==(void 0===e?"undefined":_typeof(e))){var r=a(e);o.map(function(n,t){var a=n,e=t;r.forEach(function(n,t){n.time===a.time&&(o[e].line2=n.line)})})}o.map(function(n){var t=$("<span></span>"),a=$("<span></span>"),e=$("<p></p>");t.attr({class:"origin-lrc-line"}).text(n.line),a.attr({class:"translate-lrc-line"}).text(n.line2),e.attr({"data-time":n.time,class:"lrc-line"}).append(t,a),i.append(e)}),s.append(i)}):$("<p></p>").attr({class:"lrc-line"}).text("纯音乐，无歌词").appendTo(i).appendTo(s)}var o=window.location.search,r=Number(o.match(/\?id=(\d+)/)[1]);$.get("//owf5g9dnv.bkt.clouddn.com/songsDB.json?v=20170922").then(function(a){var o=a[r],s=o.coverUrl,i=o.backgroundImgUrl,c=o.url,l=o.songName,p=o.songAuthor,d=o.hasLrc;n(s,i),t(c),e(l,p,d,r)})});